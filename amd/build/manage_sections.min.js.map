{"version":3,"file":"manage_sections.min.js","sources":["../src/manage_sections.js"],"sourcesContent":["// This file is part of Moodle - http://moodle.org/\n//\n// Moodle is free software: you can redistribute it and/or modify\n// it under the terms of the GNU General Public License as published by\n// the Free Software Foundation, either version 3 of the License, or\n// (at your option) any later version.\n//\n// Moodle is distributed in the hope that it will be useful,\n// but WITHOUT ANY WARRANTY; without even the implied warranty of\n// MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n// GNU General Public License for more details.\n//\n// You should have received a copy of the GNU General Public License\n// along with Moodle.  If not, see <http://www.gnu.org/licenses/>.\n\n/**\n * JavaScript for managing sections in training evaluation.\n *\n * @module      mod_trainingevaluation/manage_sections\n * @copyright   Pelorus Labs\n * @license     http://www.gnu.org/copyleft/gpl.html GNU GPL v3 or later\n */\n\nimport ModalFactory from 'core/modal_factory';\nimport ModalEvents from 'core/modal_events';\nimport {get_string as getString} from 'core/str';\nimport Ajax from 'core/ajax';\nimport Notification from 'core/notification';\nimport Templates from 'core/templates';\n\nexport const init = (trainingevaluationId) => {\n    initAddSectionButton(trainingevaluationId);\n    initAddSubsectionButtons(trainingevaluationId);\n    initAddItemButtons(trainingevaluationId);\n\n    initEditSectionButtons(trainingevaluationId);\n    initEditItemButtons(trainingevaluationId);\n\n    initDeleteSectionButtons(trainingevaluationId);\n    initDeleteItemButtons(trainingevaluationId);\n\n    initReorderSectionButtons();\n    initReorderItemButtons();\n};\n\n/**\n * Initialise the add section button.\n *\n * @param {number} trainingevaluationId\n */\nconst initAddSectionButton = (trainingevaluationId) => {\n    const addSectionButton = document.getElementById('mod-trainingevaluation-add-section-btn');\n\n    if (!addSectionButton) {\n        return;\n    }\n\n    addSectionButton.addEventListener('click', () => {\n        showSectionModal(trainingevaluationId);\n    });\n};\n\n/**\n * Initialise \"Add Subsection\" buttons\n *\n * @param {number} trainingevaluationId\n */\nconst initAddSubsectionButtons = (trainingevaluationId) => {\n    document.querySelectorAll('.mod-trainingevaluation-add-section-btn').forEach(button => {\n        button.addEventListener('click', () => {\n            const parentSectionId = button.dataset.parentSectionId;\n            showSectionModal(trainingevaluationId, parentSectionId);\n        });\n    });\n};\n\n/**\n * Initialise add item buttons\n *\n * @param {number} trainingevaluationId\n */\nconst initAddItemButtons = (trainingevaluationId) => {\n    document.querySelectorAll('.mod-trainingevaluation-add-item-btn').forEach(button => {\n        button.addEventListener('click', () => {\n            const sectionId = button.dataset.sectionId;\n            showItemModal(trainingevaluationId, sectionId);\n        });\n    });\n};\n\n/**\n * Initialise edit item buttons\n *\n * @param {number} trainingevaluationId\n */\nconst initEditItemButtons = (trainingevaluationId) => {\n    document.querySelectorAll('.mod-trainingevaluation-edit-item-btn').forEach(button => {\n        button.addEventListener('click', e => {\n            e.stopPropagation(); // Prevent triggering the section toggle\n            const itemId = parseInt(button.dataset.itemId);\n            showEditItemModal(trainingevaluationId, itemId);\n        });\n    });\n};\n\n/**\n * Show the modal for editing an item\n *\n * @param {number} trainingevaluationId\n * @param {number} itemId\n */\nconst showEditItemModal = async (trainingevaluationId, itemId) => {\n    try {\n        const itemData = await getItemData(itemId);\n\n        const title = await getString('edititem', 'trainingevaluation');\n\n        const {html, js} = await renderTypeConfig(itemData.type, itemData.config || {});\n\n        // Create the modal with existing item data\n        const modal = await ModalFactory.create({\n            type: ModalFactory.types.SAVE_CANCEL,\n            title: title,\n            body: Templates.render('mod_trainingevaluation/edit_item_modal', {\n                name: itemData.name,\n                description: itemData.description,\n                isrequired: itemData.isrequired,\n                typeConfigHtml: html\n            })\n        });\n\n        // Run the JS in the modal body after it's rendered so any JS needing to modify the DOM can run.\n        modal.getRoot().on(ModalEvents.bodyRendered, () => {\n            if (js) {\n                Templates.runTemplateJS(js);\n            }\n        });\n\n        modal.getRoot().on(ModalEvents.save, e => {\n            e.preventDefault();\n\n            const itemNameInput = modal.getRoot().find('#edititemname');\n            const itemName = itemNameInput.val().trim();\n\n            if (!itemName) {\n                Notification.alert('', getString('enteritemname', 'trainingevaluation'));\n                return;\n            }\n\n            const itemDescriptionInput = modal.getRoot().find('#edititemdescription');\n            const itemDescription = itemDescriptionInput.val().trim();\n\n            const itemIsRequired = modal.getRoot().find('#edititemisrequired').is(':checked');\n\n            const config = collectTypeConfig(itemData.type, modal.getRoot());\n\n            updateItem(itemId, itemName, itemDescription, itemIsRequired, null, config)\n                .then(() => {\n                    window.location.reload();\n                })\n                .catch(error => {\n                    Notification.exception(error);\n                });\n        });\n\n        modal.show();\n    } catch (error) {\n        Notification.exception(error);\n    }\n};\n\n/**\n * Render the type-specific configuration template\n *\n * @param {string} itemType - The item type\n * @param {object} config - The item configuration\n * @return {Promise<{html: *, js: *}>} - The rendered HTML\n */\nconst renderTypeConfig = async (itemType, config) => {\n    const templateName = `mod_trainingevaluation/item_config_${itemType}`;\n\n    try {\n        const {html, js} = await Templates.renderForPromise(templateName, config);\n\n        return {html, js};\n    } catch (error) {\n        return '';\n    }\n};\n\n/**\n * Collect type-specific configuration from the form\n *\n * @param {string} itemType - The item type\n * @param {jQuery} modalRoot - The modal root element\n * @return {object} - The configuration object\n */\nconst collectTypeConfig = (itemType, modalRoot) => {\n    const config = {};\n\n    switch (itemType) {\n        case 'textinput': {\n            const maxLength = modalRoot.find('#editmaxlength').val();\n            const rows = modalRoot.find('#editrows').val();\n            const placeholdertext = modalRoot.find('#editplaceholdertext').val();\n            if (maxLength) {\n                config.maxlength = maxLength;\n            }\n            if (placeholdertext) {\n                config.placeholdertext = placeholdertext;\n            }\n            if (rows) {\n                config.rows = rows;\n            }\n            break;\n        }\n\n        case 'selectmenu': {\n            const options = modalRoot.find('#editselectmenuoptions').val();\n            if (options) {\n                config.options = JSON.parse(options);\n            }\n            break;\n        }\n\n        case 'fileupload': {\n            const filetypes = modalRoot.find('#editfiletypes').val();\n            if (filetypes) {\n                config.filetypes = filetypes;\n            }\n            break;\n        }\n    }\n\n    return config;\n};\n\n/**\n * Update an item via AJAX\n *\n * @param {number} id\n * @param {string} name\n * @param {string} description\n * @param {bool} isrequired\n * @param {string|null} movement direction of movement\n * @param {object|null} config item type config\n * @returns {Promise<void>}\n */\nconst updateItem = async (id, name, description, isrequired, movement = null, config = null) => {\n    try {\n        const response = await Ajax.call([{\n            methodname: 'mod_trainingevaluation_update_item',\n            args: {\n                id: id,\n                name: name,\n                description: description,\n                isrequired: isrequired,\n                movement: movement,\n                config: config !== null ? JSON.stringify(config) : null\n            }\n        }]);\n\n        return response[0];\n    } catch (error) {\n        Notification.exception(error);\n        throw error;\n    }\n};\n\n/**\n * Initialise edit section buttons\n *\n * @param {number} trainingevaluationId\n */\nconst initEditSectionButtons = (trainingevaluationId) => {\n    document.querySelectorAll('.mod-trainingevaluation-edit-section-btn').forEach(button => {\n        button.addEventListener('click', e => {\n            e.stopPropagation(); // Prevent triggering the section toggle\n            const sectionId = parseInt(button.dataset.sectionId);\n            showEditSectionModal(trainingevaluationId, sectionId);\n        });\n    });\n};\n\n/**\n * Show the modal for editing a section\n *\n * @param {number} trainingevaluationId training evaluation instance ID\n * @param {number} sectionId section ID to edit\n */\nconst showEditSectionModal = async (trainingevaluationId, sectionId) => {\n    try {\n        const sectionData = await getSectionData(sectionId);\n\n        const title = await getString('editsection', 'trainingevaluation');\n\n        // Create the modal with existing section data\n        const modal = await ModalFactory.create({\n            type: ModalFactory.types.SAVE_CANCEL,\n            title: title,\n            body: Templates.render('mod_trainingevaluation/edit_section_modal', {\n                sectionName: sectionData.name\n            })\n        });\n\n        // Populate the form fields when modal is ready\n        modal.getRoot().on(ModalEvents.shown, () => {\n            const sectionNameInput = modal.getRoot().find('#editsectionname');\n            sectionNameInput.val(sectionData.name);\n            sectionNameInput.focus();\n        });\n\n        modal.getRoot().on(ModalEvents.save, e => {\n            e.preventDefault();\n\n            const sectionNameInput = modal.getRoot().find('#editsectionname');\n            const sectionName = sectionNameInput.val().trim();\n\n            if (!sectionName) {\n                Notification.alert('', 'Please enter a section name');\n                return;\n            }\n\n            updateSection(sectionId, sectionName)\n                .then(() => {\n                    modal.destroy();\n                    // Update the section name in the DOM without reloading\n                    updateSectionNameInDOM(sectionId, sectionName);\n                })\n                .catch(error => {\n                    Notification.exception(error);\n                });\n        });\n\n        modal.show();\n    } catch (error) {\n        Notification.exception(error);\n    }\n};\n\n/**\n * Initialise delete section buttons\n *\n * @param {number} trainingevaluationId\n */\nconst initDeleteSectionButtons = (trainingevaluationId) => {\n    document.querySelectorAll('.mod-trainingevaluation-delete-section-btn').forEach(button => {\n        button.addEventListener('click', e => {\n            e.stopPropagation(); // Prevent triggering the section toggle\n            const sectionId = parseInt(button.dataset.sectionId);\n            showDeleteSectionModal(trainingevaluationId, sectionId);\n        });\n    });\n};\n\n/**\n * Show the modal for deleting a section\n *\n * @param {number} trainingevaluationId training evaluation instance ID\n * @param {number} sectionId section ID to edit\n */\nconst showDeleteSectionModal = async (trainingevaluationId, sectionId) => {\n    try {\n        const sectionData = await getSectionData(sectionId);\n\n        const title = await getString('deletesection', 'trainingevaluation');\n\n        // Create the modal with existing section data\n        const modal = await ModalFactory.create({\n            type: ModalFactory.types.SAVE_CANCEL,\n            title: title,\n            body: Templates.render('mod_trainingevaluation/delete_section_modal', {\n                sectionName: sectionData.name\n            })\n        });\n\n        modal.getRoot().on(ModalEvents.save, e => {\n            e.preventDefault();\n\n            deleteSection(sectionId)\n                .then(() => {\n                    window.location.reload();\n                })\n                .catch(error => {\n                    Notification.exception(error);\n                });\n        });\n\n        modal.show();\n    } catch (error) {\n        Notification.exception(error);\n    }\n};\n\n/**\n * Initialise delete item buttons\n *\n * @param {number} trainingevaluationId\n */\nconst initDeleteItemButtons = (trainingevaluationId) => {\n    document.querySelectorAll('.mod-trainingevaluation-delete-item-btn').forEach(button => {\n        button.addEventListener('click', e => {\n            e.stopPropagation(); // Prevent triggering the section toggle\n            const itemId = parseInt(button.dataset.itemId);\n            showDeleteItemModal(trainingevaluationId, itemId);\n        });\n    });\n};\n\n/**\n * Show the modal for deleting an item\n *\n * @param {number} trainingevaluationId\n * @param {number} itemId\n */\nconst showDeleteItemModal = async (trainingevaluationId, itemId) => {\n    try {\n        const itemData = await getItemData(itemId);\n\n        const title = await getString('deleteitem', 'trainingevaluation');\n\n        // Create the modal with existing item data\n        const modal = await ModalFactory.create({\n            type: ModalFactory.types.SAVE_CANCEL,\n            title: title,\n            body: Templates.render('mod_trainingevaluation/delete_item_modal', {\n                itemName: itemData.name\n            })\n        });\n\n        modal.getRoot().on(ModalEvents.save, e => {\n            e.preventDefault();\n            deleteItem(itemId)\n                .then(() => {\n                    window.location.reload();\n                })\n                .catch(error => {\n                    Notification.exception(error);\n                });\n        });\n\n        modal.show();\n    } catch (error) {\n        Notification.exception(error);\n    }\n};\n\n/**\n * Initialise reorder section buttons\n */\nconst initReorderSectionButtons = () => {\n    document.querySelectorAll('.mod-trainingevaluation-up-section-btn').forEach(button => {\n        button.addEventListener('click', () => {\n            const sectionId = parseInt(button.dataset.sectionId);\n            updateSection(sectionId, null, 'up')\n                .then(() => {\n                    window.location.reload();\n                })\n                .catch(error => {\n                    Notification.exception(error);\n                });\n        });\n    });\n    document.querySelectorAll('.mod-trainingevaluation-down-section-btn').forEach(button => {\n        button.addEventListener('click', () => {\n            const sectionId = parseInt(button.dataset.sectionId);\n            updateSection(sectionId, null, 'down')\n                .then(() => {\n                    window.location.reload();\n                })\n                .catch(error => {\n                    Notification.exception(error);\n                });\n        });\n    });\n};\n\n/**\n * Initialise reorder item buttons\n */\nconst initReorderItemButtons = () => {\n    document.querySelectorAll('.mod-trainingevaluation-up-item-btn').forEach(button => {\n        button.addEventListener('click', () => {\n            const itemId = parseInt(button.dataset.itemId);\n            updateItem(itemId, null, null, null, 'up')\n                .then(() => {\n                    window.location.reload();\n                })\n                .catch(error => {\n                    Notification.exception(error);\n                });\n        });\n    });\n    document.querySelectorAll('.mod-trainingevaluation-down-item-btn').forEach(button => {\n        button.addEventListener('click', () => {\n            const itemId = parseInt(button.dataset.itemId);\n            updateItem(itemId, null, null, null, 'down')\n                .then(() => {\n                    window.location.reload();\n                })\n                .catch(error => {\n                    Notification.exception(error);\n                });\n        });\n    });\n};\n\n/**\n * Get item data\n *\n * @param {number} itemId\n * @returns {Promise<*>}\n */\nconst getItemData = async (itemId) => {\n    try {\n        const response = await Ajax.call([{\n            methodname: 'mod_trainingevaluation_get_item',\n            args: {\n                id: itemId\n            }\n        }])[0];\n\n        if (response.config !== null) {\n            response.config = JSON.parse(response.config);\n        }\n\n        return response;\n    } catch (error) {\n        Notification.exception(error);\n        throw error;\n    }\n};\n\n/**\n * Delete an item via AJAX\n *\n * @param {number} itemId\n * @returns {*}\n */\nconst deleteItem = (itemId) => {\n    return Ajax.call([{\n        methodname: 'mod_trainingevaluation_delete_item',\n        args: {\n            id: itemId\n        }\n    }])[0];\n};\n\n/**\n * Get section data for editing\n *\n * @param {number} sectionId section ID to get data for\n * @return {Promise<Object>} promise resolving to section data\n */\nconst getSectionData = async (sectionId) => {\n    try {\n        const response = await Ajax.call([{\n            methodname: 'mod_trainingevaluation_get_section',\n            args: {\n                id: sectionId\n            }\n        }]);\n\n        return response[0];\n    } catch (error) {\n        Notification.exception(error);\n        throw error;\n    }\n};\n\n/**\n * Update a section via AJAX\n *\n * @param {number} sectionId section ID to update\n * @param {string} sectionName new section name\n * @param {string|null} movement direction of movement\n * @return {Promise} Promise resolving when a section is updated\n */\nconst updateSection = async (sectionId, sectionName, movement = null) => {\n    try {\n        const response = await Ajax.call([{\n            methodname: 'mod_trainingevaluation_update_section',\n            args: {\n                id: sectionId,\n                name: sectionName,\n                movement: movement\n            }\n        }]);\n\n        return response[0];\n    } catch (error) {\n        Notification.exception(error);\n        throw error;\n    }\n};\n\n/**\n * Update the section name in the DOM without requiring a page reload\n *\n * @param {number} sectionId section ID\n * @param {string} sectionName new section name\n */\nconst updateSectionNameInDOM = (sectionId, sectionName) => {\n    // Find the section element\n    const sectionElement = document.querySelector(`.mod-trainingevaluation-section[data-section-id=\"${sectionId}\"]`);\n    if (sectionElement) {\n        // Find and update the title element\n        const titleElement = sectionElement.querySelector('.mod-trainingevaluation-section-title');\n        if (titleElement) {\n            titleElement.textContent = sectionName;\n        }\n    }\n};\n\n/**\n * Delete the section\n *\n * @param {number} sectionId\n */\nconst deleteSection = (sectionId) => {\n    return Ajax.call([{\n        methodname: 'mod_trainingevaluation_delete_section',\n        args: {\n            id: sectionId\n        }\n    }])[0];\n};\n\n/**\n * Show the modal for adding a section or subsection\n *\n * @param {number} trainingevaluationId\n * @param {number|null} parentSectionId parent section ID (for subsections) or null (for top-level sections)\n */\nconst showSectionModal = async (trainingevaluationId, parentSectionId = null) => {\n    try {\n        // Get the appropriate title string\n        const titleKey = parentSectionId ? 'addsubsection' : 'addsection';\n        const title = await getString(titleKey, 'trainingevaluation');\n\n        // Create the modal\n        const modal = await ModalFactory.create({\n            type: ModalFactory.types.SAVE_CANCEL,\n            title: title,\n            body: Templates.render('mod_trainingevaluation/add_section_modal', {isSubsection: !!parentSectionId})\n        });\n\n        // When the save button is clicked\n        modal.getRoot().on(ModalEvents.save, e => {\n            e.preventDefault();\n\n            const sectionNameInput = modal.getRoot().find('#newsectionname');\n            const sectionName = sectionNameInput.val().trim();\n\n            if (!sectionName) {\n                // Show error if section name is empty\n                Notification.alert(\n                    getString('error', 'core'),\n                    getString('sectionnamerequired', 'trainingevaluation')\n                );\n                return;\n            }\n\n            // Save the new section via AJAX\n            saveNewSection(trainingevaluationId, sectionName, parentSectionId)\n                .then(() => {\n                    // Reload the page to show the new section\n                    window.location.reload();\n                })\n                .catch(error => {\n                    Notification.exception(error);\n                });\n        });\n\n        // Display the modal\n        modal.show();\n    } catch (error) {\n        Notification.exception(error);\n    }\n};\n\n/**\n * Show the modal for adding an item to a section\n *\n * @param {number} trainingevaluationId\n * @param {number} sectionId section ID to add the item to\n */\nconst showItemModal = async (trainingevaluationId, sectionId) => {\n    try {\n        // Create the modal\n        const modal = await ModalFactory.create({\n            type: ModalFactory.types.SAVE_CANCEL,\n            title: await getString('additem', 'trainingevaluation'),\n            body: Templates.render('mod_trainingevaluation/add_item_modal', {})\n        });\n\n        // When the save button is clicked\n        modal.getRoot().on(ModalEvents.save, e => {\n            e.preventDefault();\n\n            const itemNameInput = modal.getRoot().find('#newitemname');\n            const itemName = itemNameInput.val().trim();\n            const itemDescriptionInput = modal.getRoot().find('#newitemdescription');\n            const itemDescription = itemDescriptionInput.val().trim();\n            const itemIsRequired = modal.getRoot().find('#edititemisrequired').is(':checked');\n            const itemTypeInput = modal.getRoot().find('#newitemtype');\n            const itemType = itemTypeInput.val().trim();\n\n            if (!itemName || !itemType) {\n                // Show error if item name is empty\n                Notification.alert(\n                    getString('error', 'core'),\n                    getString('itemnamerequired', 'trainingevaluation')\n                );\n                return;\n            }\n\n            // Save the new item via AJAX\n            saveNewItem(trainingevaluationId, sectionId, itemName, itemDescription, itemIsRequired, itemType)\n                .then(() => {\n                    // Reload the page to show the new item\n                    window.location.reload();\n                })\n                .catch(error => {\n                    Notification.exception(error);\n                });\n        });\n\n        // Display the modal\n        modal.show();\n    } catch (error) {\n        Notification.exception(error);\n    }\n};\n\n/**\n * Save a new section via AJAX\n *\n * @param {number} trainingevaluationId\n * @param {string} sectionName name for the new section\n * @param {number|null} parentSectionId parent section ID (for subsections) or null (for top-level sections)\n * @returns {Promise} A promise that resolves when the section is saved\n */\nconst saveNewSection = (trainingevaluationId, sectionName, parentSectionId = null) => {\n    return Ajax.call([{\n        methodname: 'mod_trainingevaluation_add_section',\n        args: {\n            wtid: trainingevaluationId,\n            name: sectionName,\n            parentsection: parentSectionId\n        }\n    }])[0];\n};\n\n/**\n * Save a new item via AJAX\n *\n * @param {number} trainingevaluationId\n * @param {number} sectionId section ID to add the item to\n * @param {string} name name for the new item\n * @param {string} description description for the new item\n * @param {boolean} isrequired whether the item is required for completion\n * @param {string} type type of the new item\n * @returns {Promise} A promise that resolves when the item is saved\n */\nconst saveNewItem = (trainingevaluationId, sectionId, name, description, isrequired, type) => {\n    return Ajax.call([{\n        methodname: 'mod_trainingevaluation_add_item',\n        args: {\n            wtid: trainingevaluationId,\n            sectionid: sectionId,\n            name: name,\n            description: description,\n            isrequired: isrequired,\n            type: type\n        }\n    }])[0];\n};\n"],"names":["trainingevaluationId","initAddSectionButton","initAddSubsectionButtons","initAddItemButtons","initEditSectionButtons","initEditItemButtons","initDeleteSectionButtons","initDeleteItemButtons","initReorderSectionButtons","initReorderItemButtons","addSectionButton","document","getElementById","addEventListener","showSectionModal","querySelectorAll","forEach","button","parentSectionId","dataset","sectionId","showItemModal","e","stopPropagation","itemId","parseInt","showEditItemModal","async","itemData","getItemData","title","html","js","renderTypeConfig","type","config","modal","ModalFactory","create","types","SAVE_CANCEL","body","Templates","render","name","description","isrequired","typeConfigHtml","getRoot","on","ModalEvents","bodyRendered","runTemplateJS","save","preventDefault","itemName","find","val","trim","alert","itemDescription","itemIsRequired","is","collectTypeConfig","updateItem","then","window","location","reload","catch","error","exception","show","itemType","templateName","renderForPromise","modalRoot","maxLength","rows","placeholdertext","maxlength","options","JSON","parse","filetypes","id","movement","Ajax","call","methodname","args","stringify","showEditSectionModal","sectionData","getSectionData","sectionName","shown","sectionNameInput","focus","updateSection","destroy","updateSectionNameInDOM","showDeleteSectionModal","deleteSection","showDeleteItemModal","deleteItem","response","sectionElement","querySelector","titleElement","textContent","titleKey","isSubsection","saveNewSection","saveNewItem","wtid","parentsection","sectionid"],"mappings":"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"}